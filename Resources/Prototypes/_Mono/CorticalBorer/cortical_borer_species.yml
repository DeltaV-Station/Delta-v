# SPDX-FileCopyrightText: 2025 Ark
# SPDX-FileCopyrightText: 2025 Coenx-flex
# SPDX-FileCopyrightText: 2025 Cojoke
# SPDX-FileCopyrightText: 2025 Redrover1760
# SPDX-FileCopyrightText: 2025 ark1368
# SPDX-FileCopyrightText: 2025 tonotom
#
# SPDX-License-Identifier: AGPL-3.0-or-later

- type: entity
  name: Cortical Borer
  parent: SimpleSpaceMobBase
  id: MobCorticalBorer
  description: A worm that burrows into brains and lays its eggs. # DeltaV - added a period
  components:
  - type: GhostRole
    makeSentient: true
    allowSpeech: False
    allowMovement: true
    requirements:
    - !type:OverallPlaytimeRequirement
      time: 36000 # 10 hrs
    name: cortical-borer-ghostrole-name
    description: cortical-borer-ghostrole-desc
    rules: ghost-role-information-freeagent-rules
    mindRoles:
    - MindRoleGhostRoleFreeAgent
  - type: GhostTakeoverAvailable
  - type: Sprite
    drawdepth: SmallMobs
    sprite: _Mono/Mobs/Aliens/cortical_borer.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: cortical_borer
  - type: DamageStateVisuals
    states:
      Alive:
        Base: cortical_borer
      Dead:
        Base: dead
  - type: Item
    size: Tiny
    heldPrefix: 0
  - type: Physics
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.2
        density: 100
        mask:
        - SmallMobMask
        layer:
        - SmallMobLayer
  - type: MobState
  - type: MobThresholds
    thresholds:
      0: Alive
      20: Dead
  - type: Barotrauma # take away space immunity but still not gasp
    damage:
      types:
        Blunt: 0.15
  - type: Bloodstream
    bloodlossDamage:
      types:
        Bloodloss: 0.5
    bloodlossHealDamage:
      types:
        Bloodloss: -1
    bleedReductionAmount: 2 # bleeding stops faster
  - type: MovementSpeedModifier
    baseWalkSpeed : 1.9
    baseSprintSpeed : 7.5
  - type: Tag
    tags:
    - Meat
  - type: ThermalVision
    color: "#ae65bf"
    lightRadius: 15
    activateSound: null
    deactivateSound: null
  - type: CorticalBorer
    eggProto: "CorticalBorerEgg"
    addOnInfest:
    - type: PressureImmunity
    removeOnInfest:
    - type: CanEscapeInventory
  - type: UserInterface
    interfaces:
      enum.CorticalBorerDispenserUiKey.Key:
        type: CorticalBorerDispenserBoundUserInterface
      enum.HealthAnalyzerUiKey.Key:
        type: HealthAnalyzerBoundUserInterface
  #- type: CollectiveMind # DeltaV - don't got it, maybe port it
  #  channel: CorticalBorer
  - type: Speech
    enabled: false
  - type: HealthAnalyzer
    scanningEndSound:
      path: "/Audio/Voice/Slime/slime_squish.ogg"
    maxScanRange: .5
  - type: CanEscapeInventory
  #- type: GuideHelp # DeltaV - nuh uh
  #  guides:
  #  - CorticalBorerGuide
  - type: Body
    #thermalVisibility: false # DeltaV - we dont got this (sad!)
  #- type: UniversalLanguageSpeaker # DeltaV - no language (sad!)

- type: entity
  parent: BaseItem
  id: CorticalBorerEgg
  name: cortical borer egg
  description: This egg is so nice and wet and soft...
  components:
  - type: Sprite
    sprite: _Mono/Mobs/Aliens/cortical_borer_egg.rsi
    state: icon
  - type: Item
    size: Tiny
  - type: GhostRole
    name: cortical-borer-ghostrole-name
    description: cortical-borer-ghostrole-desc
    rules: ghost-role-information-freeagent-rules
    requirements:
    - !type:OverallPlaytimeRequirement
      time: 36000 # 10 hrs
    mindRoles:
    - MindRoleGhostRoleFreeAgent
  - type: GhostRoleMobSpawner
    prototype: MobCorticalBorer
  - type: Damageable
    damageContainer: Biological
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 1
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: desecration
      - !type:DoActsBehavior
        acts: [ "Destruction" ]
  #- type: GuideHelp # DeltaV - nuh uh
  #  guides:
  #  - CorticalBorerGuide
